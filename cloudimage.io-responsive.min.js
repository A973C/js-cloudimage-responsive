!function(window,document){function isImgSizeIsObject(e){return 2<e.length&&0===e.indexOf("{")&&e.indexOf("}")===e.length-1}function onerrorImg(e){this.removeEventListener("error",onerrorImg,!1),this.addEventListener("error",onerrorImgStep2,!1),this.src=this.getAttribute("ci-local-url")}function onerrorImgStep2(){this.removeEventListener("error",onerrorImgStep2,!1),this.src="https://placeimg.com/500/500/animals"}window.jScaler=window.jScaler||{},jScaler.setConfig=function(e){e=e||{},jScaler.config={TOKEN:e.TOKEN||"",CONTAINER:e.CONTAINER||".cloudimg.io",DEFAULT_WIDTH:e.DEFAULT_WIDTH||"400",DEFAULT_HEIGHT:e.DEFAULT_HEIGHT||"300",DEFAULT_TYPE:e.DEFAULT_TYPE||"width",DEFAULT_PARAMS:e.DEFAULT_PARAMS||"none",BASE_URL:e.BASE_URL||"/",PRESETS:e.PRESETS||{xs:576,sm:768,md:992,lg:1200,xl:1920},ORDER:e.ORDER||["xl","lg","md","sm","xs"],AUTO:e.AUTO||[1920,1200,992,768,576]}},jScaler.init=function(){this.backgroundImgIndex=0,this.head=document.head||document.getElementsByTagName("head")[0],"trunc"in Math||(Math.trunc=Math.floor)},jScaler.process=function(e){this.setConfig(e);var i=document.querySelectorAll("img[ci-src]"),t=document.querySelectorAll("[ci-img-background]");0<i.length&&(i=Array.prototype.slice.call(i)).forEach(function(e){e.addEventListener("error",onerrorImg,!1),this.attr(e,"src")||this.processImage(e)},this),0<t.length&&(t=Array.prototype.slice.call(t)).forEach(function(e){0<=this.attr(e,"ci-img-index")&&this.processBackgroundImage(e)},this)},jScaler.processImage=function(img){var sourceUrl="ci-src",imgType=this.attr(img,"ci-type")||this.config.DEFAULT_TYPE||"",imgSize=this.attr(img,"ci-size")||this.getDefaultSize(imgType)||"",imgParams=this.attr(img,"ci-params")||this.config.DEFAULT_PARAMS||"",isLocalUrl=this.isLocalURL(img,sourceUrl),isResponsive=null!==this.attr(img,"ci-responsive"),imgSrc=this.getImgSrc(img,sourceUrl,isLocalUrl),cloudimageUrl;this.wrap(img),isResponsive?(imgSize=eval("("+imgSize+")"),cloudimageUrl=this.generateUrl("cdn","x","none",imgSrc)):cloudimageUrl=this.generateUrl(imgType,imgSize,imgParams,imgSrc),img.setAttribute("src",cloudimageUrl),this.addSources(img,imgType,imgSize,imgParams,imgSrc,isResponsive)},jScaler.processBackgroundImage=function(e){var i=null!==this.attr(e,"ci-responsive"),t=this.attr(e,"ci-type")||this.config.DEFAULT_TYPE||"",r=this.getBackgroundImgSize(e,t,i),n=this.attr(e,"ci-params")||this.config.DEFAULT_PARAMS||"",s=this.getBackgroundImgUrl(e,"ci-img-background");e.setAttribute("ci-img-index",this.backgroundImgIndex.toString()),this.backgroundImgIndex++,this.addCss(e,t,r,n,s,i)},jScaler.generateUrl=function(e,i,t,r){return"//"+this.config.TOKEN+this.config.CONTAINER+"/"+e+"/"+i+"/"+t+"/"+r},jScaler.addSources=function(e,i,t,r,n,s){if(s){for(var c in t)if(t.hasOwnProperty(c)){var a=this.generateSrcset(i,t[c],r,n),o="(max-width:"+this.config.PRESETS[c]+"px)";this.before(e,'<source media="'+o+'" srcset="'+a+'">')}}else this.before(e,'<source srcset="'+this.generateSrcset(i,t,r,n)+'">')},jScaler.getImgSrc=function(e,i,t){var r=this.attr(e,i);return t&&(e.setAttribute("ci-local-url",r),r=this.config.BASE_URL+r),r},jScaler.getBackgroundImgUrl=function(e,i){var t,r=this.attr(e,i)||"";return r||this.setUrlFromElemProperty(e,i),t=this.isLocalURL(e,i),r=this.getImgSrc(e,i,t)},jScaler.generateImgSrc=function(e,i,t,r,n,s){var c=Math.trunc(r*s);return n&&(c+="x"+Math.trunc(n*s)),this.generateUrl(e,c,i,t)},jScaler.generateSrcset=function(e,i,t,r){var n=i.toString().split("x")[0],s=i.toString().split("x")[1];return this.generateImgSrc(e,t,r,n,s,1)+" 1x, "+this.generateImgSrc(e,t,r,n,s,1.5)+" 1.5x, "+this.generateImgSrc(e,t,r,n,s,2)+" 2x, "+this.generateImgSrc(e,t,r,n,s,3)+" 3x"},jScaler.generateMediaQueries=function(e,i,t,r,n,s,c){var a=this.attr(e,"ci-selector-suffix")||"",o='[ci-img-index="'+this.attr(e,"ci-img-index")+'"]'+a,g=this.attr(e,"ci-important")?" !important":"",m=t.toString().split("x")[0],l=t.toString().split("x")[1],h=s?" (max-width: "+c+"px) and ":"",d=s?"} ":"";return(s?"@media (max-width: "+c+"px) {":"")+o+" { background-image: url("+this.generateImgSrc(i,r,n,m,l,1)+")"+g+"; } "+d+"@media"+h+"(-webkit-min-device-pixel-ratio: 1.5) { "+o+" { background-image: url("+this.generateImgSrc(i,r,n,m,l,1.5)+")"+g+"; } } @media"+h+"(-webkit-min-device-pixel-ratio: 2) { "+o+" { background-image: url("+this.generateImgSrc(i,r,n,m,l,2)+")"+g+"; } } @media"+h+"(-webkit-min-device-pixel-ratio: 3) { "+o+" { background-image: url("+this.generateImgSrc(i,r,n,m,l,3)+")"+g+"; } } "},jScaler.getDefaultSize=function(e){var i="";switch(e){case"width":i=this.config.DEFAULT_WIDTH;break;case"height":i=this.config.DEFAULT_HEIGHT;break;case"crop":case"fit":case"cover":case"bound":default:i=this.config.DEFAULT_WIDTH+"x"+this.config.DEFAULT_HEIGHT}return i},jScaler.setUrlFromElemProperty=function(e,i){e.setAttribute(i,window.getComputedStyle(e).backgroundImage.slice(5,-2))},jScaler.setSizeFromElemProperty=function(e,i){var t=parseInt(window.getComputedStyle(e).width),r=parseInt(window.getComputedStyle(e).height);return t&&"width"===i?t:r&&"width"===i?r:t&&r?t+"x"+r:void 0},jScaler.getBackgroundImgSize=function(e,i,t){var r=this.attr(e,"ci-size")||"";return r||t||(r=this.setSizeFromElemProperty(e,i)||this.getDefaultSize(i)),r||""},jScaler.addCss=function(elem,imgType,imgSize,imgParams,imgSrc,isResponsive){var i,size,mediaQuery;if(isResponsive){var cssQueries="";if("full_screen"===imgSize||""===imgSize||null===this.attr(elem,"ci-size"))for(i=0;i<this.config.AUTO.length;i++)imgSize=this.config.AUTO[i],cssQueries+=this.generateMediaQueries(elem,"width",imgSize,imgParams,imgSrc,isResponsive,imgSize);else if(isImgSizeIsObject(imgSize))for(imgSize=eval("("+imgSize+")"),i=0;i<this.config.ORDER.length;i++)size=imgSize[this.config.ORDER[i]],mediaQuery=this.config.PRESETS[this.config.ORDER[i]],size&&(cssQueries+=this.generateMediaQueries(elem,imgType,size,imgParams,imgSrc,isResponsive,mediaQuery));this.addStyles(cssQueries)}else this.addStyles(this.generateMediaQueries(elem,imgType,imgSize,imgParams,imgSrc,isResponsive))},jScaler.addStyles=function(e){var i=document.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),this.head.appendChild(i)},jScaler.isLocalURL=function(e,i){var t=this.attr(e,i)||"";return 0===t.indexOf("//")&&(t=window.location.protocol+t,e.setAttribute(i,t)),0!==t.indexOf("http://")&&0!==t.indexOf("https://")&&0!==t.indexOf("//")},jScaler.wrap=function(e,i){return i=i||document.createElement("picture"),e.nextSibling?e.parentNode.insertBefore(i,e.nextSibling):e.parentNode.appendChild(i),i.appendChild(e)},jScaler.before=function(e,i){var t,r=document.createElement("template");"content"in r?(r.innerHTML=i,e.parentNode.insertBefore(r.content.firstChild,e)):((t=document.createElement("div")).innerHTML=i,e.parentNode.insertBefore(t.firstChild,e))},jScaler.attr=function(e,i){return e.getAttribute(i)},jScaler.init()}(window,document);